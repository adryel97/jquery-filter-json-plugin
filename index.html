<!DOCTYPE html>
<html>
	<head>
    	<meta charset='utf-8' />
    	<meta http-equiv="X-UA-Compatible" content="chrome=1" />
    	<meta name="description" content="jquery-filter-json-plugin : A jQuery utility that allows you to filter a JSON based on properties." />
    	<title>jquery-filter-json-plugin</title>
    	
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.6.min.js"></script>
		<script type="text/javascript" src="http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js"></script>
		<script type="text/javascript">
		/*
		 * jQuery Filter JSON Plugin
		 * Copyright (c) 2012 Kapil Kashyap
		 *
		 * Depends:
		 *   - jQuery 1.6+
		 *
		 * Dual licensed under the MIT and GPL licenses:
		 *   - http://www.opensource.org/licenses/mit-license.php
		 *   - http://www.gnu.org/licenses/gpl.html
		 */
		!function(e){e.extend(e.fn,{filterJSON:function(r,t){var o={STRING:"[object String]",NUMBER:"[object Number]",BOOLEAN:"[object Boolean]",ARRAY:"[object Array]",OBJECT:"[object Object]",FUNCTION:"[object Function]"},a=function(e){return Object.prototype.toString.call(e)},i={property:null,value:"",wrapper:!1,checkContains:!1,startsWith:!1,matchCase:!1,avoidDuplicates:!1,sort:!1,sortOrder:"asc",sortProperty:null,comparator:function(e,r){var t="asc"!==i.sortOrder?-1:1,o=i.sortProperty||i.property[0]||i.property,e=e[o]||e,r=r[o]||r;return r>e?-1*t:e>r?1*t:0}},n=function(r,t){var i=null;return(e.isEmptyObject(t.property)||!t.property[0])&&(i="config.property is required to filter the JSON object."),e.isEmptyObject(i)?(r&&"object"==typeof r&&e.each(r,function(i,s){if(-1!=e.inArray(i,t.property)){var c=function(r,o){var a=t.wrapper?r:o;t.avoidDuplicates?-1==e.inArray(a,l.filteredJSON)&&l.filteredJSON.push(a):l.filteredJSON.push(a)};if(t.value){var p=e.isArray(t.value)?t.value:[t.value],f={},u=a(s),O=function(i,l,s){if(i===o.STRING){var p=l.toLowerCase(),u=s.toLowerCase();t.matchCase?(l==s||!t.startsWith&&t.checkContains&&-1!=l.indexOf(s)||t.startsWith&&0==l.indexOf(s))&&c(r,l):(p==u||!t.startsWith&&t.checkContains&&-1!=p.indexOf(u)||t.startsWith&&0==p.indexOf(u))&&c(r,l)}else if(i===o.NUMBER)(l===parseInt(s)||l===parseFloat(s))&&c(r,l);else if(i===o.BOOLEAN){var d=!1;a(s)===o.STRING&&"true"==s.toLowerCase()&&(d=!0),l===d&&c(r,l)}else if(i===o.ARRAY){if(l.length>0)for(k in l)O(a(l[k]),l[k],s)}else i===o.OBJECT&&(e.extend(f,t,{value:s}),n(l,f))};if(p.forEach)p.forEach(function(e){O(u,s,e)});else for(k in p)p.hasOwnProperty(k)&&O(u,s,p[k])}else c(r,s)}n(s,t)}),l):void(window.console?console.error?console.error(i):console.log(i):alert(i))},l={filteredJSON:[]},s=null,c=null,p=null,f=!1;return e.extend(i,t),p=i.property,a(p)===o.STRING&&(p=p.replace(/\s/g,""),i.property=p.split(",")),p=null,i.wrapper&&i.property&&i.property.length>1&&void 0==t.avoidDuplicates&&(i.avoidDuplicates=!0),s=n(r,i),s&&s.filteredJSON&&(c=s.filteredJSON.length>0?s.filteredJSON:s.filteredJSON[0]),i.sort&&a(c)===o.ARRAY&&(i.comparator&&a(i.comparator)===o.FUNCTION&&a(c[0])===o.OBJECT&&(c.sort(i.comparator),f=!0),!f&&c.sort(i.comparator)),e(c)}})}(jQuery);
		</script>
		<script type="text/javascript" src="assets/sample.json"></script>
		
    	<link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
		<style type="text/css">
			tbody .vertical-align-top { vertical-align: top; }
    		span.required { color: red; }
			.borderless { border: none; }
    		.input-form { width: 100%; }
			.input-form-borderless { width: 100%; border: none; }
			.input-form-borderless td { border: none; }
    		.textArea { width: 98%; height: 200px; }
			.input-label,.input-label-checkbox { width: 200px; color: #000000; }
			.input-label { vertical-align: top; padding: 10px 5px 5px 10px; }
			.checkbox { margin-left: 20px; }
			.property-value-actions { display: inline-block; }
			.x-inline-block { display: inline-block; zoom: 1; *display: inline; _height: 30px; }
			.x-float-right { float: right; }
			.x-width-10px { width: 10px; }
			.x-button { background: #DDDDDD; color: #373737; border: 1px solid #373737; cursor: pointer; }
			.x-button:hover { background: #373737; color: #DDDDDD; border: 1px solid #DDDDDD; cursor: pointer; }
    	</style>
  	</head>

	<body>
    <!-- HEADER -->
	    <div id="header_wrap" class="outer">
			<header class="inner">
	        	<a id="forkme_banner" href="https://github.com/kapilkashyap/jquery-filter-json-plugin">View on GitHub</a>

	          	<h1 id="project_title">jquery-filter-json-plugin</h1>
	          	<h2 id="project_tagline">A jQuery utility that allows you to filter a JSON based on properties.</h2>

				<section id="downloads">
	            	<a class="zip_download_link" href="https://github.com/kapilkashyap/jquery-filter-json-plugin/zipball/master">Download this project as a .zip file</a>
	              	<a class="tar_download_link" href="https://github.com/kapilkashyap/jquery-filter-json-plugin/tarball/master">Download this project as a tar.gz file</a>
	            </section>
	        </header>
	    </div>

    <!-- MAIN CONTENT -->
    	<div id="main_content_wrap" class="outer">
      		<section id="main_content" class="inner">
        		<h1>jQuery Filter JSON</h1>
				<p>This jQuery plugin is a utility that allows you to filter a JSON based on properties. You can also have a property/value match and only those
				property values that match the passed in value will be returned.</p>
				
				<p>However, you can filter the JSON based on various parameters such as startWith or checkContains, matchCase and can either choose to return the 
				matched values or the parent object of the matched values. You even have the option of avoiding duplicates if any.</p>
				
				<h3 id="usage">Plugin Usage<div class="x-inline-block x-width-10px">&nbsp;</div><span style="font-size: 14px;">(<a href="#demo" onclick="javascript:void(0);">Demo</a>)</span></h3>

<div class="highlight">
<pre><span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">filterJSON</span><span class="p">({</span> <span class="nx">json</span> <span class="nx">object</span> <span class="p">},</span> <span class="p">{</span>
	<span class="nx">property</span><span class="o">:</span> <span class="p">[</span><span class="s2">"prop1"</span><span class="p">,</span> <span class="s2">"prop2"</span><span class="p">,</span> <span class="p">...</span> <span class="nx">n</span><span class="p">],</span> <span class="nx">//</span> <span class="nx required">mandatory</span>
	<span class="nx">wrapper</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
	<span class="nx">value</span><span class="o">:</span> <span class="s2">"user one"</span><span class="p">,</span>
	<span class="nx">checkContains</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
	<span class="nx">startsWith</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
	<span class="nx">matchCase</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
	<span class="nx">avoidDuplicates</span><span class="o">:</span> <span class="kc">true</span>,</span>
	<span class="nx">sort</span><span class="o">:</span> <span class="kc">true</span>,</span>
	<span class="nx">sortOrder</span><span class="o">:</span> <span class="kc">'desc'</span>
<span class="p">});</span>
</pre>
</div>

				<h3 id="docs">Plugin Properties Explained<div class="x-inline-block x-width-10px">&nbsp;</div><span style="font-size: 14px;">(<a href="#demo" onclick="javascript:void(0);">Demo</a>)</span></h3>

				<p>Before digging into each property of the plugin lets describe our sample JSON.</p>

<div class="highlight"><pre><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">"id"</span><span class="o">:</span> <span class="mi">12345</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"User One"</span><span class="p">,</span>
        <span class="s2">"email"</span><span class="o">:</span> <span class="s2">"user.one@email.com"</span>
    <span class="p">},{</span>
        <span class="s2">"id"</span><span class="o">:</span> <span class="mi">23456</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"User Two"</span><span class="p">,</span>
        <span class="s2">"email"</span><span class="o">:</span> <span class="s2">"user.two@email.com"</span>
    <span class="p">},{</span>
        <span class="s2">"id"</span><span class="o">:</span> <span class="mi">34567</span><span class="p">,</span>
        <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"User Three"</span><span class="p">,</span>
        <span class="s2">"email"</span><span class="o">:</span> <span class="s2">"user.three@email.com"</span>
    <span class="p">}</span>
    <span class="p">.</span>
    <span class="p">.</span>
    <span class="p">.</span>
<span class="p">]</span>
</pre></div>
<br/>
				<table>
					<tr>
						<th>Property</th>
						<th>Type</th>
						<th>Default</th>
						<th>Description</th>
					</tr>
					<tr>
						<td>property&nbsp;<span class="required">*</span></td>
						<td>array</td>
						<td>null</td>
						<td>This options takes a property or an array of properties that you need to filter the JSON with. For the above sample JSON we have three properties, namely:
							id, name and email. So you can set this value as ["name"] or ["name", "email"]</td>
					</tr>
					<tr>
						<td>wrapper</td>
						<td>boolean</td>
						<td>false</td>
						<td>If set to true, will return an array of objects whose property has matched, otherwise will return an array of value itself.
							For instance if we are filtering the above sample JSON with 'name' and wrapper is set to true, then an array of all the objects which 
							have the 'name' property will be returned. If the wrapper is set to false, then an array of only the values of the property will be returned. For the above sample JSON
							["User One", "User Two", "User Three"] would be returned.</td>
					</tr>
					<tr>
						<td>value</td>
						<td>string/array</td>
						<td>[V1...Vn]</td>
						<td>An optional value passed in as a string (for a single value match) or as an array to check the matched property value against multiple values.</td>
					</tr>
					<tr>
						<td>checkContains</td>
						<td>boolean</td>
						<td>false</td>
						<td>Setting this option to true will check if the matched property's value contains the passed in value. However, passing a value becomes mandatory for this to work.
							This option will be considered only if it is true and startsWith is not set to true.</td>
					</tr>
					<tr>
						<td>startsWith</td>
						<td>boolean</td>
						<td>false</td>
						<td>Setting this option to true will check if the matched property's value starts with the passed in value. However, passing a value becomes mandatory for this to work.
							This options takes precedence over checkContains if it is set to true.</td>
					</tr>
					<tr>
						<td>matchCase</td>
						<td>boolean</td>
						<td>false</td>
						<td>If set to true will perform case-sensitive search of values.</td>
					</tr>
					<tr>
						<td>avoidDuplicates</td>
						<td>boolean</td>
						<td>false</td>
						<td>If set to true will avoid duplicate objects.</td>
					</tr>
					<tr>
						<td>sort</td>
						<td>boolean</td>
						<td>false</td>
						<td>If set to true will return sorted values.</td>
					</tr>
					<tr>
						<td>sortOrder</td>
						<td>string</td>
						<td>'asc'</td>
						<td>If sorting is set to true then the default sort order is ascending described by 'asc' value. If you want your sort order to be descending change this value to 'desc' or for the matter of fact anything else other than 'asc'.</td>
					</tr>
					<tr>
						<td>sortProperty</td>
						<td>string</td>
						<td>null</td>
						<td>The key to be used to sort the objects if sorting is set to true. If not provided then the required property 'property' would be used. In case multiple properties are provided use the first one.</td>
					</tr>
					<tr>
						<td>comparator</td>
						<td>function</td>
						<td>function</td>
						<td>A comparator function used for sorting. This is completely optional but can be provided by the user.</td>
					</tr>
				</table>
<br/>
				<div id="demo">
					<div class="x-float-right x-inline-block"><a href="#docs" onclick="javascript:void(0);">Docs</a></div>
					<div class="x-float-right x-inline-block x-width-10px">&nbsp;</div>
					<div class="x-float-right x-inline-block"><a href="#usage" onclick="javascript:void(0);">Usage</a></div>
				</div>	
				<table class="input-form">
					<tr>
						<th>Demo</th>
						<th>&nbsp;</th>
					</tr>
					<tr>
						<td class="input-label vertical-align-top">
							JSON:
							<table class="borderless">
								<tr>
									<td class="borderless">Use:</td>
									<td class="borderless"><input type="radio" name="sample-select" value="sample1">Sample1</td>
								</tr>
								<tr>
									<td class="borderless">&nbsp;</td>
									<td class="borderless"><input type="radio" name="sample-select" value="sample2">Sample2</td>
								</tr>
								<tr>
									<td class="borderless">&nbsp;</td>
									<td class="borderless"><input type="radio" name="sample-select" value="sample3">Sample3</td>
								</tr>
							</table>
						</td>
						<td class="input-field">
							<textarea id="json" class="textArea" name="json"></textarea>
						</td>
					</tr>
					
					<tr>
						<td class="input-label">Property:</td>
						<td class="input-field">
							<input type="text" id="property" name="property" value="email" />
							<div class="property-actions x-inline-block">
								<input type="checkbox" id="avoidDuplicates" class="checkbox" name="avoidDuplicates" value="" checked="checked"/>
								<span class="input-label-checkbox">Avoid Duplicates</span>
							</div>
						</td>
					</tr>
					
					<tr>
						<td class="input-label">Return Parent Object:</td>
						<td class="input-field">
							<input type="checkbox" id="wrapper" name="wrapper" value=""/>
						</td>
					</tr>
					
					<tr>
						<td class="input-label">Property Value:</td>
						<td class="input-field">
							<input type="text" id="propertyValue" name="propertyValue" value="" />
						</td>
					</tr>
					
					<tr>
						<td class="input-label">Matching Criteria:</td>
						<td class="input-field">
							<input type="radio" id="isStartsWith" class="" name="searchcriteria" value="" checked="checked"/>
							<span class="input-label-checkbox">Starts With</span>
							<input type="radio" id="isCheckContains" class="checkbox" name="searchcriteria" value="" />
							<span class="input-label-checkbox">Check Contains</span>
							<input type="checkbox" id="isMatchCase" class="checkbox" name="isMatchCase" value="" />
							<span class="input-label-checkbox">Match Case</span>
						</td>
					</tr>

					<tr>
						<td class="input-label">Sort Settings:</td>
						<td>
							<table class="input-form-borderless">
								<tr>
									<td class="vertical-align-top">Sort:</td>
									<td>
										<input type="checkbox" id="isSortRequired" class="" name="isSortRequired" value="" />
									</td>
								</tr>
								<tr>
									<td class="vertical-align-top">Sort Order:</td>
									<td>
										<select id="sortOrder" name="sortOrder">
											<option value="asc">Ascending</option>
											<option value="desc">Descending</option>
										</select>
									</td>
								</tr>
								<tr>
									<td class="vertical-align-top">Sort Property:</td>
									<td>
										<input type="text" id="sortProperty" name="sortProperty" value="" />
									</td>
								</tr>
								<tr>
									<td class="vertical-align-top">Sort Comparator:</td>
									<td>
										<textarea id="sortComparatorFn" class="textArea" name="sortComparatorFn"/></textarea>
									</td>
								</tr>
							</table>
						</td>
					</tr>
					
					<tr class="input-row vertical-align-top">
						<td class="input-label">Filtered JSON:</td>
						<td class="input-field">
							<textarea id="filteredJson" class="textArea" readonly/></textarea>
						</td>
					</tr>
					<tr>
						<td colspan="2" class="borderless">
							<button id="filterJSON" name="Apply" class="x-button">Filter JSON</button>
							<span id="info"></span>
						</td>
					</tr>
				</table>

				<h3>Known Issues</h3>
				<p>For this plugin to work in IE7 and below, you will have to include JSON2.</p>
				<p>You can use: <a href="http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js">http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js</a></p>
				<h3>Licence</h3>
				<p>Copyright (c) 2012 Kapil Kashyap. Dual licensed under MIT License and GPL License.</p>
      		</section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      	<footer class="inner">
        	<p class="copyright">jquery-filter-json-plugin maintained by <a href="https://github.com/kapilkashyap">kapilkashyap</a></p>
        	<p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      	</footer>
    </div>
  	</body>

	<script>
		var $ = jQuery.noConflict();
		
		$( document ).ready(function() {
			$( ":input[name='sample-select']" ).click(function(e) {
				$( "#json" ).val( JSON.stringify( sample[$( this ).val()] ) );
			});
			
			// selecting the first json sample
			$( ":input[name='sample-select']:last" ).click();
			
			$( "#filterJSON" ).click(function() {
				var startTime = new Date().getTime(),
					json = $.parseJSON( $( "#json" ).val() ),
					property = $( "#property" ).val(),
					propertyValue = $( "#propertyValue" ).val().trim();
					
				$( "#filteredJson" ).val( "" );

				try {
					var config = {
							property: property.split(","),
							wrapper: $( "#wrapper" ).is( ":checked" ),
							value: propertyValue === "" ? null : propertyValue.split(","),
							checkContains: $( "#isCheckContains" ).is( ":checked" ),
							startsWith: $( "#isStartsWith" ).is( ":checked" ),
							matchCase: $( "#isMatchCase" ).is( ":checked" ),
							avoidDuplicates: $( "#avoidDuplicates" ).is( ":checked" ),
							sort: $( "#isSortRequired" ).is( ":checked" ),
							sortOrder: $( "#sortOrder" ).val(),
							sortProperty: $( "#sortProperty" ).val()
						},
						o = null;
						
						if($( "#sortComparatorFn" ).val() !== "") {
							try {
								config.comparator = eval( "(" + $( "#sortComparatorFn" ).val() + ")" );
							}
							catch( e ) {
								console.error( e.message );
							}
						}
						
						o = $.fn.filterJSON(json, config).toArray();

					$( "#filteredJson" ).val( (o != null && o.length > 0) ? JSON.stringify( o ) : "" );
					$( "#info" ).html("Returned " + o.length + " results in " + (new Date().getTime() - startTime) + " milliseconds.");
				}
				catch( e ) {
					console.error( e.message );
				}
			});
			
			$( "#propertyValue" ).keyup();
		});
	</script>
	
	<script type="text/javascript">
  		var _gaq = _gaq || [];
  		_gaq.push(['_setAccount', 'UA-39875161-1']);
  		_gaq.push(['_trackPageview']);

  		(function() {
    		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  		})();
	</script>
</html>
